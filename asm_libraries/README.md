# Assembly Libraries

Libraries needed required by the assembler to convert the assembly generated by the compiler into binary.

## os.s
The processor I'm targeting has two sets of registers, one used in kernel mode and one used in user mode. 
A few of the kernel mode registers have special meanings, such as enabling interrupts or setting the memory map.
Kernel mode also also has an expanded instruction set. 
Right now, the compiler assumes the code it generates will be run in user mode, but the processor starts up in kernel mode. 
The way I deal with this for now is concatenating whatever the compiler generates after the `os.s` file when assembling. 
This code will be loaded into kernel space when the simulation is run. 
All the OS code does is copy the code generated by the compiler into user space, then enter user mode and run the code. 
The compiler generates a `sys EXIT` instruction at the end of `main`, so control will returned to the OS, which for now just halts the processor.

## arithmetic.s

The processor targeted by the compiler does not have multiplication or division instructions (or mod, left/right shift by an arbitrary amount).
To compile these operations, calls to the assembly routines in this file are generated.
The code is slow and uses loops of repeated addition to multiply, so at some point I'll rewrite it to use shifts.